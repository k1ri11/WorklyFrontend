# Workly Frontend

Система трекинга вовлечённости сотрудников - фронтенд приложение.

## Технологии

- **React 19** - UI библиотека
- **TypeScript** - типизация
- **Tailwind CSS** - стилизация
- **React Router DOM 7** - навигация
- **Axios** - HTTP клиент с интерцепторами
- **React Hot Toast** - уведомления
- **Recharts** - графики и диаграммы
- **date-fns** - работа с датами
- **Headless UI** - доступные компоненты

## Структура проекта

```
src/
├── api/              # Axios instance и эндпоинты
├── components/       # Переиспользуемые UI компоненты (Header, Button, Input, Card, Modal и т.д.)
├── context/          # React Context (AuthContext)
├── features/         # Функциональные модули (auth, users, departments, positions, sessions, statistics)
├── hooks/            # Общие хуки
├── pages/            # Страницы приложения (LoginPage, UsersPage, DashboardPage и т.д.)
├── routes/           # Настройка роутинга
├── styles/           # Глобальные стили
├── types/            # TypeScript типы (сгенерированные из OpenAPI)
└── utils/            # Утилиты и константы
```

## Установка и запуск

### 1. Установка зависимостей

```bash
npm install
```

### 2. Настройка окружения

Создайте файл `.env` в корне проекта:

```env
REACT_APP_API_BASE_URL=http://localhost:8080
```

### 3. Запуск приложения

```bash
npm start
```

Приложение откроется по адресу: [http://localhost:3000](http://localhost:3000)

### 4. Сборка для продакшена

```bash
npm run build
```

## Дизайн система

### Цветовая схема

- **Primary (Indigo):** `#6366f1` (primary-500) - основной акцентный цвет
- **Primary Dark:** `#4f46e5` (primary-600) - для кнопок и активных элементов
- **Success (Green):** `#10b981` - успешные операции
- **Danger (Red):** `#ef4444` - опасные действия, ошибки
- **Gray:** различные оттенки для текста и фонов

### Типографика

- **Font Family:** Inter, system fonts
- **Sizes:**
  - Заголовки: `text-2xl` (24px)
  - Подзаголовки: `text-lg` (18px)
  - Основной текст: `text-base` (16px)
  - Вторичный текст: `text-sm` (14px)

## Доступные страницы

### `/login` - Страница входа
- Email и пароль
- Валидация полей
- Обработка ошибок
- Автоматический редирект при успешной аутентификации

### `/users` - Список сотрудников (защищённый роут)
- Карточки сотрудников
- Поиск по имени/email
- Фильтр по отделам
- Пагинация
- Добавление, редактирование и удаление сотрудников
- Переход к детальной информации о сотруднике

### `/users/:id` - Детальная информация о сотруднике (защищённый роут)
- Основная информация о сотруднике
- График работы
- История сессий
- Редактирование данных (имя, отдел, должность)

### `/departments` - Список отделов (защищённый роут)
- Карточки отделов
- Переход к детальной информации об отделе

### `/departments/:id` - Детальная информация об отделе (защищённый роут)
- Информация об отделе (название, описание, руководитель)
- Список сотрудников отдела
- Редактирование информации об отделе
- Добавление и удаление сотрудников из отдела

### `/profile` - Профиль текущего пользователя (защищённый роут)
- Основная информация
- График работы
- История сессий
- Редактирование имени

### `/dashboard` - Дашборд со статистикой (защищённый роут)
- Фильтры по дате и отделу
- Статистические карточки (количество сотрудников, сессий, среднее время работы и т.д.)
- График ежедневной вовлечённости
- Топ сотрудников по вовлечённости с сортировкой

## Аутентификация

Приложение использует JWT токены:
- **Access Token** - для API запросов (добавляется автоматически через Request Interceptor)
- **Refresh Token** - для обновления access токена
- Токены хранятся в `localStorage`
- При ошибке 401 пользователь автоматически перенаправляется на страницу входа
- Автоматическая проверка токена при загрузке приложения

## Управление рабочими сессиями

В Header интегрирован компонент управления рабочим днём:
- **Начало рабочего дня** - запуск таймера сессии
- **Пауза** - остановка таймера с указанием причины
- **Возобновление** - продолжение работы после паузы
- **Завершение рабочего дня** - окончание сессии
- Отображение текущей длительности работы в реальном времени
- Индикация активной сессии (зелёный индикатор)

## Генерация типов из OpenAPI

Типы генерируются из `openapi.yaml`:

```bash
npx openapi-typescript openapi.yaml -o src/types/api.ts
```

После обновления OpenAPI схемы необходимо перегенерировать типы.

## Скрипты

- `npm start` - запуск dev сервера
- `npm run build` - сборка для продакшена

## API

Backend должен быть запущен на `http://localhost:8080`.

API endpoints определены в `src/api/endpoints.ts`.

## Обработка ошибок

Приложение информирует пользователя о:
- Ошибках валидации форм
- Сетевых ошибках
- Пустых результатах поиска
- Необратимых операциях (удаление)
- Ошибках аутентификации (401)

Используются:
- **Toast уведомления** (react-hot-toast) - для мгновенной обратной связи
- **Confirm Dialog** - для подтверждения опасных действий
- **Inline ошибки** - под полями форм
- **Состояния ошибок** - на страницах
- **Автоматический редирект** - при ошибках аутентификации

## Визуализация данных

- **Recharts** - для построения графиков (AreaChart для ежедневной вовлечённости)
- **EngagementCircle** - круговая диаграмма вовлечённости сотрудников
- **DateRangePicker** - выбор периода для статистики
- Цветовая индикация уровня вовлечённости (зелёный, синий, жёлтый, красный)

## Действия пользователя

### Аутентификация
- **Вход в систему** - авторизация по email и паролю на странице `/login`
- **Выход из системы** - кнопка выхода в Header, очистка токенов и редирект на страницу входа

### Управление рабочими сессиями
- **Начало рабочего дня** - запуск таймера сессии через кнопку в Header
- **Пауза** - остановка таймера с указанием причины паузы
- **Возобновление работы** - продолжение работы после паузы
- **Завершение рабочего дня** - окончание сессии, сохранение данных о рабочем времени
- **Просмотр текущей длительности** - отображение времени работы в реальном времени в Header

### Управление сотрудниками
- **Просмотр списка сотрудников** - страница `/users` с карточками всех сотрудников
- **Поиск сотрудников** - поиск по имени или email в реальном времени
- **Фильтрация по отделам** - выбор отдела для отображения сотрудников конкретного отдела
- **Пагинация** - навигация по страницам списка сотрудников
- **Просмотр детальной информации** - переход на страницу `/users/:id` с полной информацией о сотруднике
- **Добавление сотрудника** - создание нового сотрудника через модальное окно (имя, email, отдел, должность)
- **Редактирование сотрудника** - изменение имени, отдела и должности сотрудника
- **Удаление сотрудника** - удаление с подтверждением через диалог
- **Просмотр графика работы** - отображение расписания работы сотрудника
- **Просмотр истории сессий** - список всех рабочих сессий сотрудника с деталями

### Управление отделами
- **Просмотр списка отделов** - страница `/departments` с карточками всех отделов
- **Просмотр детальной информации об отделе** - переход на страницу `/departments/:id`
- **Редактирование отдела** - изменение названия и описания отдела в режиме редактирования
- **Просмотр сотрудников отдела** - список всех сотрудников, принадлежащих отделу
- **Добавление сотрудников в отдел** - выбор сотрудников из списка доступных и добавление их в отдел
- **Удаление сотрудников из отдела** - удаление сотрудников из отдела в режиме редактирования

### Профиль пользователя
- **Просмотр профиля** - страница `/profile` с информацией о текущем пользователе
- **Редактирование имени** - изменение своего имени в профиле
- **Просмотр графика работы** - отображение своего расписания работы
- **Просмотр истории сессий** - список всех своих рабочих сессий

### Дашборд и статистика
- **Выбор периода** - выбор даты начала и окончания периода через DateRangePicker
- **Фильтрация по отделам** - выбор конкретного отдела или "Все отделы" для статистики
- **Просмотр статистики** - карточки с метриками:
  - Количество сотрудников
  - Количество сессий
  - Среднее время работы
  - Среднее время перерыва
  - Количество отклонений от графика работы
- **Просмотр графика вовлечённости** - график ежедневной вовлечённости за выбранный период
- **Просмотр топ сотрудников** - список сотрудников с наивысшей или наименьшей вовлечённостью
- **Сортировка топ сотрудников** - переключение между "Лучшие" и "Худшие" по вовлечённости
- **Просмотр метрик сотрудников** - среднее время работы и процент вовлечённости для каждого сотрудника

